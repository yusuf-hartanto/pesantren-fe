(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1806],{84754:(a,e,t)=>{Promise.resolve().then(t.bind(t,16153))},16153:(a,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>u});var l=t(95155),r=t(12115),s=t(48173),n=t.n(s),i=t(91068),d=t(2295),o=t(81638),c=t(83785);function u(){let a=(0,o.j)(),e=(0,r.useRef)(null),[t,s]=(0,r.useState)("commit"),[u,h]=(0,r.useState)(null),p=async()=>{try{let e=await a((0,c.RU)({template:1})).unwrap();if((null==e?void 0:e.status)&&(null==e?void 0:e.data)){let a="".concat("http://103.197.190.47:5001").concat(e.data),t=document.createElement("a");t.href=a,t.download="",document.body.appendChild(t),t.click(),document.body.removeChild(t)}}catch(a){i.oR.error("Gagal download template")}finally{}},m=async()=>{console.warn(t,u,e)};return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 py-10 px-4",children:(0,l.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)(n(),{href:"/app/tahun-ajaran/list",className:"inline-flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900",children:[(0,l.jsx)("i",{className:"tabler-arrow-back-up"})," Kembali"]}),(0,l.jsx)("h1",{className:"text-xl font-semibold mt-2",children:"Import CSV"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"border border-blue-200 bg-blue-50 rounded-lg p-4 text-sm text-blue-700",children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Petunjuk Import"}),(0,l.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,l.jsx)("li",{children:"Format file: CSV (encoding UTF-8)"}),(0,l.jsxs)("li",{children:["Jika ",(0,l.jsx)("b",{children:"tahun_ajaran"})," kosong → INSERT (data baru)"]}),(0,l.jsxs)("li",{children:["Jika ",(0,l.jsx)("b",{children:"tahun_ajaran"})," ada → UPDATE (perbarui data)"]}),(0,l.jsx)("li",{children:"Mode Preview: hanya validasi tanpa menyimpan"}),(0,l.jsx)("li",{children:"Mode Commit: validasi dan simpan ke database"})]}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)("a",{className:"text-blue-600 underline hover:text-blue-400 cursor-pointer",onClick:p,children:(0,l.jsx)("b",{children:"Download Template CSV"})})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block font-medium mb-2",children:"Mode Import"}),(0,l.jsxs)("div",{className:"flex gap-6 text-sm",children:[(0,l.jsxs)("label",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"radio",name:"mode",value:"preview",checked:"preview"===t,onChange:()=>s("preview")}),"Preview (Validasi saja)"]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"radio",name:"mode",value:"commit",checked:"commit"===t,onChange:()=>s("commit")}),"Commit (Simpan data)"]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block font-medium mb-2",children:"File CSV"}),(0,l.jsxs)("div",{onClick:()=>{var a;return null===(a=e.current)||void 0===a?void 0:a.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-blue-400 transition",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,l.jsx)("div",{className:"text-gray-400",children:(0,l.jsx)("i",{className:"tabler-arrow-big-up"})}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Klik untuk upload file CSV"}),(0,l.jsx)("button",{type:"button",className:"px-2 py-1 bg-blue-600 text-white rounded-md text-sm",children:"Pilih File"}),u&&(0,l.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:u})]}),(0,l.jsx)("input",{ref:e,type:"file",accept:".csv,.xls,.xlsx",className:"hidden",onChange:a=>{var e;let t=null===(e=a.target.files)||void 0===e?void 0:e[0];if(t){if(!["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type)){alert("File harus CSV atau Excel"),a.target.value="";return}h(t.name)}}})]})]}),(0,l.jsx)(d.default,{size:"small",fullWidth:!0,variant:"contained",sx:{height:32,fontSize:"0.75rem",px:2},onClick:m,startIcon:(0,l.jsx)("i",{className:"tabler-file-import"}),children:"Import & Simpan"})]})]})})}},83785:(a,e,t)=>{"use strict";t.d(e,{Ay:()=>f,EG:()=>v,Nn:()=>u,RD:()=>i,RU:()=>p,U7:()=>d,WI:()=>o,bi:()=>n,dY:()=>c});var l=t(48943),r=t(83197);let s={dataPage:{values:[],total:0},data:{},datas:[],crud:null,delete:null,import:null,export:null},n=(0,l.zD)("tahun-ajaran/fetchAll",async(a,e)=>{try{return(await r.A.get("/app/tahun-ajaran/all-data",{params:a})).data}catch(a){var t;return e.fulfillWithValue(null===(t=a.response)||void 0===t?void 0:t.data)}}),i=(0,l.zD)("tahun-ajaran/fetchPage",async(a,e)=>{try{return(await r.A.get("/app/tahun-ajaran",{params:a})).data}catch(a){var t;return e.fulfillWithValue(null===(t=a.response)||void 0===t?void 0:t.data)}}),d=(0,l.zD)("tahun-ajaran/fetchById",async(a,e)=>{try{return(await r.A.get("/app/tahun-ajaran/".concat(a))).data}catch(a){var t;return e.fulfillWithValue(null===(t=a.response)||void 0===t?void 0:t.data)}}),o=(0,l.zD)("tahun-ajaran/create",async(a,e)=>{try{return(await r.A.post("/app/tahun-ajaran",a)).data}catch(a){var t;return e.fulfillWithValue(null===(t=a.response)||void 0===t?void 0:t.data)}}),c=(0,l.zD)("tahun-ajaran/update",async(a,e)=>{let{id:t,params:l}=a;try{return(await r.A.put("/app/tahun-ajaran/".concat(t),l)).data}catch(a){var s;return e.fulfillWithValue(null===(s=a.response)||void 0===s?void 0:s.data)}}),u=(0,l.zD)("tahun-ajaran/delete",async(a,e)=>{try{return(await r.A.delete("/app/tahun-ajaran/".concat(a))).data}catch(a){var t;return e.fulfillWithValue(null===(t=a.response)||void 0===t?void 0:t.data)}}),h=(0,l.zD)("tahun-ajaran/import",async(a,e)=>{try{return(await r.A.post("/app/tahun-ajaran/import",a)).data}catch(a){var t;return e.fulfillWithValue(null===(t=a.response)||void 0===t?void 0:t.data)}}),p=(0,l.zD)("tahun-ajaran/export",async(a,e)=>{try{return(await r.A.post("/app/tahun-ajaran/export",a)).data}catch(a){var t;return e.fulfillWithValue(null===(t=a.response)||void 0===t?void 0:t.data)}}),m=(0,l.Z0)({name:"tahun_ajaran",initialState:s,reducers:{resetRedux:()=>s},extraReducers:a=>{a.addCase(n.fulfilled,(a,e)=>{a.datas=e.payload.data||[]}),a.addCase(i.fulfilled,(a,e)=>{var t,l;a.dataPage={values:(null===(t=e.payload.data)||void 0===t?void 0:t.values)||[],total:(null===(l=e.payload.data)||void 0===l?void 0:l.total)||0}}),a.addCase(d.fulfilled,(a,e)=>{a.data=e.payload.data}),a.addCase(u.fulfilled,(a,e)=>{a.delete=e.payload.message}),a.addCase(o.fulfilled,(a,e)=>{a.crud=e.payload}),a.addCase(c.fulfilled,(a,e)=>{a.crud=e.payload}),a.addCase(h.fulfilled,(a,e)=>{a.import=e.payload}),a.addCase(p.fulfilled,(a,e)=>{a.export=e.payload})}}),{resetRedux:v}=m.actions,f=m.reducer},83197:(a,e,t)=>{"use strict";t.d(e,{A:()=>c});var l=t(82651),r=t(2615),s=t(68411);let n=l.A.create({baseURL:"http://103.197.190.47:5001"}),i=!1,d=[];n.defaults.showLoading=!0;let o=function(a){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;d.forEach(t=>{a?t.reject(a):t.resolve(e)}),d=[]};n.interceptors.request.use(async a=>{var e;let t=await (0,r.getSession)();return(null==t?void 0:t.access_token)&&(a.headers.Authorization="Bearer ".concat(t.access_token)),(null!==(e=a.showLoading)&&void 0!==e?e:n.defaults.showLoading)&&(s.L.start(),s.L.progress(10)),a}),n.interceptors.response.use(a=>{var e;return(null!==(e=a.config.showLoading)&&void 0!==e?e:n.defaults.showLoading)&&(s.L.progress(100),setTimeout(()=>{s.L.stop(),s.L.progress(0)},300)),a},async a=>{var e,t;let l=a.config;if((null!==(t=l.showLoading)&&void 0!==t?t:n.defaults.showLoading)&&(s.L.stop(),s.L.progress(0)),(null===(e=a.response)||void 0===e?void 0:e.status)===401&&!l._retry){if(i)return new Promise((a,e)=>{d.push({resolve:a,reject:e})}).then(a=>(l.headers.Authorization="Bearer ".concat(a),n(l))).catch(a=>Promise.reject(a));l._retry=!0,i=!0;try{let e=await fetch("/api/auth/refresh",{method:"GET"}),t=await e.json();if((null==t?void 0:t.error)==="RefreshAccessTokenError")return(0,r.signOut)(),Promise.reject(a);let s=null==t?void 0:t.access_token;return o(null,s),i=!1,l.headers.Authorization="Bearer ".concat(s),n(l)}catch(a){return o(a,null),i=!1,(0,r.signOut)(),Promise.reject(a)}}return Promise.reject(a)});let c=n},68411:(a,e,t)=>{"use strict";t.d(e,{L:()=>n});let l=[],r=[],s=0,n={subscribe:a=>(l.push(a),()=>{l=l.filter(e=>e!==a)}),emit(a){l.forEach(e=>e(a))},start(){s++,this.emit(!0)},stop(){--s<=0&&(s=0,this.emit(!1))},onProgress:a=>(r.push(a),()=>{r=r.filter(e=>e!==a)}),progress(a){r.forEach(e=>e(a))}}},81638:(a,e,t)=>{"use strict";t.d(e,{G:()=>s,j:()=>r});var l=t(83391);let r=l.wA,s=a=>(0,l.d4)(a)}},a=>{var e=e=>a(a.s=e);a.O(0,[5876,777,2295,8173,2615,505,2651,1068,8441,1517,7358],()=>e(84754)),_N_E=a.O()}]);