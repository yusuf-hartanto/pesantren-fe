(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1143],{94593:(e,a,l)=>{Promise.resolve().then(l.bind(l,38700))},38700:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>u});var t=l(95155),r=l(12115),s=l(48173),i=l.n(s),n=l(91068),o=l(2295),d=l(81638),c=l(84698);function u(){let e=(0,d.j)(),a=(0,r.useRef)(null),[l,s]=(0,r.useState)("commit"),[u,p]=(0,r.useState)(null),m=async()=>{try{let a=await e((0,c.RU)({template:1})).unwrap();if((null==a?void 0:a.status)&&(null==a?void 0:a.data)){let e="".concat("http://103.197.190.47:5001").concat(a.data),l=document.createElement("a");l.href=e,l.download="",document.body.appendChild(l),l.click(),document.body.removeChild(l)}}catch(e){n.oR.error("Gagal download template")}finally{}},h=async()=>{console.warn(l,u,a)};return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-10 px-4",children:(0,t.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)(i(),{href:"/app/kelompok-pelajaran/list",className:"inline-flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900",children:[(0,t.jsx)("i",{className:"tabler-arrow-back-up"})," Kembali"]}),(0,t.jsx)("h1",{className:"text-xl font-semibold mt-2",children:"Import CSV"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"border border-blue-200 bg-blue-50 rounded-lg p-4 text-sm text-blue-700",children:[(0,t.jsx)("h3",{className:"font-medium mb-2",children:"Petunjuk Import"}),(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,t.jsx)("li",{children:"Format file: CSV (encoding UTF-8)"}),(0,t.jsxs)("li",{children:["Jika ",(0,t.jsx)("b",{children:"nama_kelpelajaran"})," kosong → INSERT (data baru)"]}),(0,t.jsxs)("li",{children:["Jika ",(0,t.jsx)("b",{children:"nama_kelpelajaran"})," ada → UPDATE (perbarui data)"]}),(0,t.jsx)("li",{children:"Mode Preview: hanya validasi tanpa menyimpan"}),(0,t.jsx)("li",{children:"Mode Commit: validasi dan simpan ke database"})]}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)("a",{className:"text-blue-600 underline hover:text-blue-400 cursor-pointer",onClick:m,children:(0,t.jsx)("b",{children:"Download Template CSV"})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-2",children:"Mode Import"}),(0,t.jsxs)("div",{className:"flex gap-6 text-sm",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",name:"mode",value:"preview",checked:"preview"===l,onChange:()=>s("preview")}),"Preview (Validasi saja)"]}),(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",name:"mode",value:"commit",checked:"commit"===l,onChange:()=>s("commit")}),"Commit (Simpan data)"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-2",children:"File CSV"}),(0,t.jsxs)("div",{onClick:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-blue-400 transition",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,t.jsx)("div",{className:"text-gray-400",children:(0,t.jsx)("i",{className:"tabler-arrow-big-up"})}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Klik untuk upload file CSV"}),(0,t.jsx)("button",{type:"button",className:"px-2 py-1 bg-blue-600 text-white rounded-md text-sm",children:"Pilih File"}),u&&(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:u})]}),(0,t.jsx)("input",{ref:a,type:"file",accept:".csv,.xls,.xlsx",className:"hidden",onChange:e=>{var a;let l=null===(a=e.target.files)||void 0===a?void 0:a[0];if(l){if(!["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(l.type)){alert("File harus CSV atau Excel"),e.target.value="";return}p(l.name)}}})]})]}),(0,t.jsx)(o.default,{size:"small",fullWidth:!0,variant:"contained",sx:{height:32,fontSize:"0.75rem",px:2},onClick:h,startIcon:(0,t.jsx)("i",{className:"tabler-file-import"}),children:"Import & Simpan"})]})]})})}},84698:(e,a,l)=>{"use strict";l.d(a,{Av:()=>i,Ay:()=>f,EG:()=>v,RU:()=>m,VS:()=>d,YI:()=>u,ft:()=>o,iT:()=>n,sJ:()=>c});var t=l(48943),r=l(83197);let s={dataPage:{values:[],total:0},data:{},datas:[],crud:null,delete:null,import:null,export:null},i=(0,t.zD)("kelompok_pelajaran/fetchAll",async(e,a)=>{try{return(await r.A.get("/app/kelompok-pelajaran/all-data",{params:e})).data}catch(e){var l;return a.fulfillWithValue(null===(l=e.response)||void 0===l?void 0:l.data)}}),n=(0,t.zD)("kelompok_pelajaran/fetchPage",async(e,a)=>{try{return(await r.A.get("/app/kelompok-pelajaran",{params:e})).data}catch(e){var l;return a.fulfillWithValue(null===(l=e.response)||void 0===l?void 0:l.data)}}),o=(0,t.zD)("kelompok_pelajaran/fetchById",async(e,a)=>{try{return(await r.A.get("/app/kelompok-pelajaran/".concat(e))).data}catch(e){var l;return a.fulfillWithValue(null===(l=e.response)||void 0===l?void 0:l.data)}}),d=(0,t.zD)("kelompok_pelajaran/create",async(e,a)=>{try{return(await r.A.post("/app/kelompok-pelajaran",e)).data}catch(e){var l;return a.fulfillWithValue(null===(l=e.response)||void 0===l?void 0:l.data)}}),c=(0,t.zD)("kelompok_pelajaran/update",async(e,a)=>{let{id:l,params:t}=e;try{return(await r.A.put("/app/kelompok-pelajaran/".concat(l),t)).data}catch(e){var s;return a.fulfillWithValue(null===(s=e.response)||void 0===s?void 0:s.data)}}),u=(0,t.zD)("kelompok_pelajaran/delete",async(e,a)=>{try{return(await r.A.delete("/app/kelompok-pelajaran/".concat(e))).data}catch(e){var l;return a.fulfillWithValue(null===(l=e.response)||void 0===l?void 0:l.data)}}),p=(0,t.zD)("kelompok_pelajaran/import",async(e,a)=>{try{return(await r.A.post("/app/kelompok-pelajaran/import",e)).data}catch(e){var l;return a.fulfillWithValue(null===(l=e.response)||void 0===l?void 0:l.data)}}),m=(0,t.zD)("kelompok_pelajaran/export",async(e,a)=>{try{return(await r.A.post("/app/kelompok-pelajaran/export",e)).data}catch(e){var l;return a.fulfillWithValue(null===(l=e.response)||void 0===l?void 0:l.data)}}),h=(0,t.Z0)({name:"kelompok_pelajaran",initialState:s,reducers:{resetRedux:()=>s},extraReducers:e=>{e.addCase(i.fulfilled,(e,a)=>{e.datas=a.payload.data||[]}),e.addCase(n.fulfilled,(e,a)=>{var l,t;e.dataPage={values:(null===(l=a.payload.data)||void 0===l?void 0:l.values)||[],total:(null===(t=a.payload.data)||void 0===t?void 0:t.total)||0}}),e.addCase(o.fulfilled,(e,a)=>{e.data=a.payload.data}),e.addCase(u.fulfilled,(e,a)=>{e.delete=a.payload.message}),e.addCase(d.fulfilled,(e,a)=>{e.crud=a.payload}),e.addCase(c.fulfilled,(e,a)=>{e.crud=a.payload}),e.addCase(p.fulfilled,(e,a)=>{e.import=a.payload}),e.addCase(m.fulfilled,(e,a)=>{e.export=a.payload})}}),{resetRedux:v}=h.actions,f=h.reducer},83197:(e,a,l)=>{"use strict";l.d(a,{A:()=>c});var t=l(82651),r=l(2615),s=l(68411);let i=t.A.create({baseURL:"http://103.197.190.47:5001"}),n=!1,o=[];i.defaults.showLoading=!0;let d=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o.forEach(l=>{e?l.reject(e):l.resolve(a)}),o=[]};i.interceptors.request.use(async e=>{var a;let l=await (0,r.getSession)();return(null==l?void 0:l.access_token)&&(e.headers.Authorization="Bearer ".concat(l.access_token)),(null!==(a=e.showLoading)&&void 0!==a?a:i.defaults.showLoading)&&(s.L.start(),s.L.progress(10)),e}),i.interceptors.response.use(e=>{var a;return(null!==(a=e.config.showLoading)&&void 0!==a?a:i.defaults.showLoading)&&(s.L.progress(100),setTimeout(()=>{s.L.stop(),s.L.progress(0)},300)),e},async e=>{var a,l;let t=e.config;if((null!==(l=t.showLoading)&&void 0!==l?l:i.defaults.showLoading)&&(s.L.stop(),s.L.progress(0)),(null===(a=e.response)||void 0===a?void 0:a.status)===401&&!t._retry){if(n)return new Promise((e,a)=>{o.push({resolve:e,reject:a})}).then(e=>(t.headers.Authorization="Bearer ".concat(e),i(t))).catch(e=>Promise.reject(e));t._retry=!0,n=!0;try{let a=await fetch("/api/auth/refresh",{method:"GET"}),l=await a.json();if((null==l?void 0:l.error)==="RefreshAccessTokenError")return(0,r.signOut)(),Promise.reject(e);let s=null==l?void 0:l.access_token;return d(null,s),n=!1,t.headers.Authorization="Bearer ".concat(s),i(t)}catch(e){return d(e,null),n=!1,(0,r.signOut)(),Promise.reject(e)}}return Promise.reject(e)});let c=i},68411:(e,a,l)=>{"use strict";l.d(a,{L:()=>i});let t=[],r=[],s=0,i={subscribe:e=>(t.push(e),()=>{t=t.filter(a=>a!==e)}),emit(e){t.forEach(a=>a(e))},start(){s++,this.emit(!0)},stop(){--s<=0&&(s=0,this.emit(!1))},onProgress:e=>(r.push(e),()=>{r=r.filter(a=>a!==e)}),progress(e){r.forEach(a=>a(e))}}},81638:(e,a,l)=>{"use strict";l.d(a,{G:()=>s,j:()=>r});var t=l(83391);let r=t.wA,s=e=>(0,t.d4)(e)}},e=>{var a=a=>e(e.s=a);e.O(0,[5876,777,2295,8173,2615,505,2651,1068,8441,1517,7358],()=>a(94593)),_N_E=e.O()}]);