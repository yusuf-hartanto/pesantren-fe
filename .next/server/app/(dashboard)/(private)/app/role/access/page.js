(()=>{var e={};e.id=9699,e.ids=[9699],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},73496:e=>{"use strict";e.exports=require("http2")},55591:e=>{"use strict";e.exports=require("https")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},11723:e=>{"use strict";e.exports=require("querystring")},27910:e=>{"use strict";e.exports=require("stream")},83997:e=>{"use strict";e.exports=require("tty")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},38081:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=t(70260),a=t(28203),n=t(25155),i=t.n(n),o=t(67292),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(r,l);let d=["",{children:["(dashboard)",{children:["(private)",{children:["app",{children:["role",{children:["access",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,22600)),"/Users/samsulanwar/Documents/Kerja/Freelance/pesantren-fe/src/app/(dashboard)/(private)/app/role/access/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,11088)),"/Users/samsulanwar/Documents/Kerja/Freelance/pesantren-fe/src/app/(dashboard)/(private)/layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,71354)),"/Users/samsulanwar/Documents/Kerja/Freelance/pesantren-fe/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/samsulanwar/Documents/Kerja/Freelance/pesantren-fe/src/app/(dashboard)/(private)/app/role/access/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(dashboard)/(private)/app/role/access/page",pathname:"/app/role/access",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},70719:(e,r,t)=>{Promise.resolve().then(t.bind(t,22600))},7671:(e,r,t)=>{Promise.resolve().then(t.bind(t,92860))},82614:(e,r,t)=>{"use strict";t.d(r,{a:()=>a});var s=t(58009);function a(e=1e3){let[r,t]=(0,s.useState)(!1);return r}},92860:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var s=t(45512),a=t(58009),n=t(79334),i=t(84477),o=t(44708),l=t(45669),d=t(6868),c=t(44750),u=t(90993),p=t(76892),m=t(81485),h=t(68404),x=t(66178),f=t(3932),v=t(96956),b=t(82614);let _=["view","create","edit","delete","import","export"],y={role_id:"",role_name:"",menu:[]},g=()=>{let e=(0,n.useRouter)(),{update:r}=(0,u.useSession)(),t=(0,a.useRef)({role_id:{value:"",label:""},menu:[]}),g=(0,n.useSearchParams)().get("id"),j=(0,p.j)(),w=(0,p.G)(e=>e.role),q=(0,p.G)(e=>e.role.navigation),N=(0,b.a)(1e3),[P,k]=(0,a.useState)(y),[A,E]=(0,a.useState)(!1),[C,G]=(0,a.useState)([]),{control:R,handleSubmit:S,formState:{errors:z},reset:F}=(0,d.mN)({defaultValues:y}),K=(0,a.useMemo)(()=>{let e={};return P.menu.forEach(r=>{e[r.menu_id]=r}),e},[P.menu]),M=(0,a.useMemo)(()=>Array.isArray(C)?C:[],[C]),U=e=>{let r=[],t=e=>{e.forEach(e=>{r.push({menu_id:e.menu_id,module_name:e.module_name,view:0,create:0,edit:0,delete:0,import:0,export:0,status:1}),Array.isArray(e.children)&&t(e.children)})};return t(e),r};(0,a.useEffect)(()=>{j((0,x.dp)({})).then(e=>{let r=e?.payload?.data;if(!Array.isArray(r))return;let t=(0,f.Uv)(r);j((0,m.dI)(t))}),g&&j((0,m.qi)(g)).then(e=>{let r=e?.payload?.data;r&&(k(e=>({...e,role_id:r.role_id,role_name:r.role_name})),F({role_id:r.role_id,role_name:r.role_name}),G(r.menu??[]))})},[j,g,F]);let D=(0,a.useCallback)(()=>{j((0,m.EG)()),e.replace("/app/role/list")},[j,e]);(0,a.useEffect)(()=>{if(w.crud){if(w.crud.status){c.oR.success("Success saved");let e=t.current?.menu.reduce((e,r)=>(e[v._Y(r.module_name)]={view:1===r.view,create:1===r.create,edit:1===r.edit,delete:1===r.delete,import:1===r.import,export:1===r.export},e),{}),s=Object.values(e).some(e=>!1===e.view);r({permissions:e}),s&&window.location.reload(),D()}else c.oR.error("Error saved: "+w.crud.message),E(!1)}},[D,w,r]);let Z=(e,r)=>{let t=new Map(r.map(e=>[e.menu_id,e]));return e.map(e=>t.has(e.menu_id)?{...e,...t.get(e.menu_id)}:e)};(0,a.useEffect)(()=>{if(!q.length)return;let e=Z(U(q),M);k(r=>({...r,menu:e}))},[q,M]);let I=(e,r,t)=>e.children?.length?e.children.some(e=>I(e,r,t)):t[e.menu_id]?.[r]===1,O=e=>P.menu.length>0&&P.menu.every(r=>1===r[e]),L=e=>P.menu.some(r=>1===r[e])&&!O(e),Y=(e,r)=>{k(t=>({...t,menu:t.menu.map(t=>({...t,[e]:r?1:0}))}))},$=e=>({...e,create:0,edit:0,delete:0,import:0,export:0,children:e.children?.map($)}),J=(e,r,t)=>{k(s=>({...s,menu:s.menu.map(s=>s.menu_id!==e?s:"view"!==r||t?"view"!==r&&t?{...s,view:1,[r]:1}:{...s,[r]:t?1:0}:{...$(s),view:0})}))},T=(e,r=0)=>e.map(e=>(0,s.jsxs)(a.Fragment,{children:[(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-3 py-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",style:{paddingLeft:20*r},children:[e.menu_icon&&(0,s.jsx)("i",{className:e.menu_icon}),(0,s.jsx)("span",{className:0===r?"font-semibold":"",children:e.menu_name})]})}),_.map(r=>(0,s.jsx)("td",{className:"px-3 py-2 text-center",children:(0,s.jsx)("input",{type:"checkbox",className:"w-4 h-4",checked:K[e.menu_id]?.[r]===1||I(e,r,K),disabled:"view"!==r&&K[e.menu_id]?.view===0,onChange:t=>J(e.menu_id,r,t.target.checked)})},r))]}),Array.isArray(e.children)&&T(e.children,r+1)]},e.menu_id)),X=(e,r=0)=>e.map(e=>(0,s.jsxs)("div",{className:"border rounded-lg p-3 bg-white shadow-sm",style:{marginLeft:12*r},children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[e.menu_icon&&(0,s.jsx)("i",{className:e.menu_icon}),(0,s.jsx)("span",{className:0===r?"font-semibold":"font-medium",children:e.menu_name})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:_.map(r=>{let t=K[e.menu_id]?.[r]===1||I(e,r,K),a="view"!==r&&K[e.menu_id]?.view===0;return(0,s.jsxs)("label",{className:`flex items-center justify-between text-xs border rounded px-2 py-1
                ${a?"opacity-50":""}`,children:[(0,s.jsx)("span",{className:"capitalize",children:r}),(0,s.jsx)("input",{type:"checkbox",className:"w-4 h-4",checked:t,disabled:a,onChange:t=>J(e.menu_id,r,t.target.checked)})]},r)})}),Array.isArray(e.children)&&e.children.length>0&&(0,s.jsx)("div",{className:"mt-3 space-y-2 border-l pl-3",children:X(e.children,r+1)})]},e.menu_id));return(0,s.jsxs)(i.default,{children:[(0,s.jsx)(o.default,{title:"Form Role"}),(0,s.jsx)(l.default,{children:(0,s.jsx)("form",{onSubmit:S(()=>{if(A)return;E(!0);let e={role_id:{value:P.role_id,label:P.role_name},menu:P.menu.filter(e=>_.some(r=>1===e[r]))};t.current=e,j((0,m.qY)([e]))}),autoComplete:"off",children:(0,h.v$)({control:R,errors:z,state:P,setState:k,fields:[(0,h.ZZ)({type:"text",key:"role_name",label:"Role Name",placeholder:"Input role name",required:!0,readOnly:!0}),(0,h.ZZ)({type:"custom",key:"menu",render:()=>N?(0,s.jsx)("div",{className:"space-y-3",children:X(q)}):(0,s.jsxs)("table",{className:"table w-full border border-gray-200 text-sm",children:[(0,s.jsx)("thead",{className:"bg-gray-50 sticky top-0 z-10",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-3 py-2 text-left",children:"Menu"}),_.map(e=>(0,s.jsxs)("th",{className:"px-3 py-2 text-center",children:[(0,s.jsx)("div",{className:"capitalize",children:e}),(0,s.jsx)("input",{type:"checkbox",className:"w-4 h-4",checked:O(e),ref:r=>{r&&(r.indeterminate=L(e))},onChange:r=>Y(e,r.target.checked)})]},e))]})}),(0,s.jsx)("tbody",{children:T(q)})]})}),(0,h.Jw)({onCancel:D,loading:A})]})})})]})}},22600:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/samsulanwar/Documents/Kerja/Freelance/pesantren-fe/src/app/(dashboard)/(private)/app/role/access/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/samsulanwar/Documents/Kerja/Freelance/pesantren-fe/src/app/(dashboard)/(private)/app/role/access/page.tsx","default")}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,4512,1730,6263,8531,2878,9951,8789,684,8713,1825,8969,1727,7999,8145,1578,5357,106,8957,6868,1441,9501,578,2751,7794,1815],()=>t(38081));module.exports=s})();